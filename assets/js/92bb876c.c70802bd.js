"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[6347],{7502:function(e,t,a){a.r(t),a.d(t,{contentTitle:function(){return m},default:function(){return g},frontMatter:function(){return p},metadata:function(){return u},toc:function(){return h}});var n=a(7462),i=a(3366),s=a(7294),l=a(3905),o=a(2004);function r(e){var t=e.children;return s.createElement("div",{className:"runnable-command"},t)}function c(e){var t=e.url;return s.createElement(o.Z,{playing:!0,loop:!0,muted:!0,controls:!0,width:"100%",height:"",url:t})}var d=["components"],p={title:"Getting started",sidebar_position:2},m=void 0,u={unversionedId:"getting_started",id:"getting_started",isDocsHomePage:!1,title:"Getting started",description:"This article requires knowledge of Scala language (how to define class or method) as well as Scala tooling (repl, basics of dependency management and unit tests).",source:"@site/docs/getting_started.md",sourceDirName:".",slug:"/getting_started",permalink:"/docs/getting_started",editUrl:"https://github.com/Virtuslab/scala-cli/edit/master/website/docs/getting_started.md",tags:[],version:"current",sidebarPosition:2,frontMatter:{title:"Getting started",sidebar_position:2},sidebar:"tutorialSidebar",previous:{title:"Overview",permalink:"/docs/overview"},next:{title:"Basics",permalink:"/docs/commands/basics"}},h=[{value:"Scripting",id:"scripting",children:[],level:2},{value:"Dependencies",id:"dependencies",children:[],level:2},{value:"A project",id:"a-project",children:[],level:2},{value:"IDE support",id:"ide-support",children:[],level:2},{value:"Tests",id:"tests",children:[],level:2},{value:"A project, vol 2",id:"a-project-vol-2",children:[],level:2},{value:"Packaging",id:"packaging",children:[],level:2},{value:"Summary",id:"summary",children:[],level:2}],k={toc:h};function g(e){var t=e.components,a=(0,i.Z)(e,d);return(0,l.kt)("wrapper",(0,n.Z)({},k,a,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,l.kt)("div",{parentName:"div",className:"admonition-heading"},(0,l.kt)("h5",{parentName:"div"},(0,l.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,l.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,l.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,l.kt)("div",{parentName:"div",className:"admonition-content"},(0,l.kt)("p",{parentName:"div"},"This article requires knowledge of Scala language (how to define class or method) as well as Scala tooling (repl, basics of dependency management and unit tests). "))),(0,l.kt)("p",null,"In this article we will show how to use Scala CLI to create basic script followed by small project with things like dependencies, tests and IDE support. We aime to provide you with a knowledge how to create and develop your first projects using Scala CLI."),(0,l.kt)("p",null,"Firstly, lets verify if Scala CLI is properly ",(0,l.kt)("a",{parentName:"p",href:"/install"},"installed")," with a simple hello world command:"),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"echo 'println(\"Hello\")' | scala-cli -\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Hello\n"))),(0,l.kt)("p",null,"Running the command for the first time may take a bit longer then usual and print a bit logs because Scala CLI needs to download all artifacts needed to compile and run the code."),(0,l.kt)("h2",{id:"scripting"},"Scripting"),(0,l.kt)("p",null,"In fact, we have just created a Scala Script, so let's create a script in a hello.sc file, that will actually greet properly."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=hello.sc",title:"hello.sc"},'def helloMessage(names: Seq[String]) = names match\n  case Nil => \n    "Hello!"\n  case names =>\n    names.mkString("Hello: ", ", ", "!")\n\nprintln(helloMessage(args.toSeq))\n')),(0,l.kt)("p",null,"Now let run it with:"),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli hello.sc\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Hello\n"))),(0,l.kt)("p",null,"To provide arguments to the script we need to add them after ",(0,l.kt)("inlineCode",{parentName:"p"},"--"),":"),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli hello.sc -- Jenny Jake\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Hello Jenny, Jake!\n"))),(0,l.kt)("p",null,"You may wonder what kind of Scala version was used under the hood. The answer is the latest stable one. If we want to specify the Scala version we can use ",(0,l.kt)("inlineCode",{parentName:"p"},"-S")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"--scala")," option. More about setting Scala version in a dedicated ",(0,l.kt)("a",{parentName:"p",href:"/docs/cookbooks/scala-versions"},"cookbook"),"."),(0,l.kt)("p",null,"Scala CLI offers much more features dedicated for scripting described in the ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/scripts"},"dedicated guide")),(0,l.kt)("h2",{id:"dependencies"},"Dependencies"),(0,l.kt)("p",null,"Let's build something more serious. Best start is prototyping inside REPL. We can start a repl by simply running ",(0,l.kt)("inlineCode",{parentName:"p"},"scala-cli repl")," and here we can also set a Scala version with ",(0,l.kt)("inlineCode",{parentName:"p"},"-S")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"--scala"),"."),(0,l.kt)("p",null,"*Scala CLI reuses most of its options across all its comments.**"),(0,l.kt)("p",null,"One of the main strengths of Scala is its ecosystem. Scala CLI is designed in a way to expose Scala Ecosystem to all usages of Scala and running REPL is no exception. "),(0,l.kt)("p",null,"Let's start prototyping with ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/com-lihaoyi/os-lib"},"os-lib")," - a Scala interface to common OS filesystem and subprocess. To experiment with ",(0,l.kt)("inlineCode",{parentName:"p"},"os-lib")," in repl we simply need to add a parameter ",(0,l.kt)("inlineCode",{parentName:"p"},"--dep com.lihaoyi::os-lib:0.7.8")),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash",metastring:"ignore",ignore:!0},"scala-cli repl --dep com.lihaoyi::os-lib:0.7.8\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala",metastring:"ignore",ignore:!0},"scala> os.pwd\nval res0: os.Path = ...\n\nscala> os.walk(os.pwd)\nval res1: IndexedSeq[os.Path] = ArraySeq(...)\n"))),(0,l.kt)("h2",{id:"a-project"},"A project"),(0,l.kt)("p",null,"Now is time to write some logic, based on the prototyping we have just did: a filter function to display all files with given extension in current directory. "),(0,l.kt)("p",null,"For the consistency of our results let's create a new directory and ",(0,l.kt)("inlineCode",{parentName:"p"},"cd")," to it:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir scala-cli-getting-started\ncd scala-cli-getting-started\n")),(0,l.kt)("p",null,"Now we can write our logic in ",(0,l.kt)("inlineCode",{parentName:"p"},"files.scala"),":"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=files.scala",title:"files.scala"},'// using lib com.lihaoyi::os-lib:0.7.8\n\ndef filesByExtension(\n  extension: String, \n  dir: os.Path = os.pwd): Seq[os.Path] = \n    os.walk(dir).filter { f =>\n      f.last.endsWith(s".$extension") && os.isFile(f)\n    }\n')),(0,l.kt)("p",null,"As you may have noticed we specified a dependency within the ",(0,l.kt)("inlineCode",{parentName:"p"},".scala")," using ",(0,l.kt)("inlineCode",{parentName:"p"},"// using lib com.lihaoyi::os-lib:0.7.8"),". In Scala CLI configuration can be provided through so called using directives - a dedicated syntax that can be embedded in any ",(0,l.kt)("inlineCode",{parentName:"p"},".scala")," file. We have a dedicated ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/using-directives"},"guide for using directives"),"."),(0,l.kt)("p",null,"Let's check if our code compiles. We can do that by simply running:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli compile .\n")),(0,l.kt)("p",null,"This time we did not provide path to single files but rather used a (current) directory. For project-like use-cases we recommend providing directories rather then individual files. More most cases a current directory (",(0,l.kt)("inlineCode",{parentName:"p"},"."),") is best choice."),(0,l.kt)("h2",{id:"ide-support"},"IDE support"),(0,l.kt)("p",null,"Some people are fine working using command line only, but most Scala Developers use an IDE. Let's open Metals with your favorite editor inside ",(0,l.kt)("inlineCode",{parentName:"p"},"scala-cli-getting-started")," directory."),(0,l.kt)(c,{url:"/img/scala-cli-getting-started-1.mp4",mdxType:"GiflikeVideo"}),(0,l.kt)("p",null,"At this moment support for IntelliJ is often problematic. We are working on making it as rock solid as Metals one."),(0,l.kt)("p",null,"Actually, we've cheated a bit by running compilation first. In order for Metals or IntelliJ to pick up Scala CLI project we need to generate a BSP connection detail file. Scala CLI generate such details by default every time ",(0,l.kt)("inlineCode",{parentName:"p"},"compile"),", ",(0,l.kt)("inlineCode",{parentName:"p"},"run")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"test")," are run. We expose a ",(0,l.kt)("inlineCode",{parentName:"p"},"setup-ide")," command to manually control creation of connection details file. You can find more details in  ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/ide"},"IDE guide"),"."),(0,l.kt)("h2",{id:"tests"},"Tests"),(0,l.kt)("p",null,"With IDE in place, how can we test if our code works correctly? Best way is to create unit test. The simplest way to add a test using scala-cli is by creating a file named that it ends with ",(0,l.kt)("inlineCode",{parentName:"p"},".test.scala")," like ",(0,l.kt)("inlineCode",{parentName:"p"},"files.test.scala"),". There are also other ways to mark source a test described in ",(0,l.kt)("a",{parentName:"p",href:"/docs/commands/test#test-sources"},"tests guide"),"."),(0,l.kt)("p",null,"We also need to add a test framework. Scala CLI support most popular test frameworks and for this guide we will stick to ",(0,l.kt)("a",{parentName:"p",href:"https://scalameta.org/munit/"},"munit"),". To add a test framework we just need an ordinary dependency that we will add with ",(0,l.kt)("inlineCode",{parentName:"p"},"using")," directive again:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=files.test.scala",title:"files.test.scala"},'// using lib org.scalameta::munit:1.0.0-M1\n\nclass TestSuite extends munit.FunSuite {\n  test("hello") {\n    val expected = Seq("files.scala", "files.test.scala")\n    val obtained = filesByExtension("scala").map(_.last)\n    assertEquals(obtained, expected)\n  }\n}\n')),(0,l.kt)("p",null,"Now we can run our tests in command line:   "),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli test .\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"Compiling project (test, Scala 3.0.2, JVM)\nCompiled project (test, Scala 3.0.2, JVM)\nTestSuite:\n  + hello 0.058s\n"))),(0,l.kt)("p",null,"or directly within Metals:"),(0,l.kt)(c,{url:"/img/scala-cli-getting-started-2.mp4",mdxType:"GiflikeVideo"}),(0,l.kt)("h2",{id:"a-project-vol-2"},"A project, vol 2"),(0,l.kt)("p",null,"With our code ready and tested it is now time to turn it into a command-line tool to count files by extension. For that we can write a simple script. With Scala CLI, scripts and scala sources can be mixed."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-scala",metastring:"title=countByExtension.sc",title:"countByExtension.sc"},'val (ext, directory) = args.toSeq match \n  case Seq(ext) => (ext, os.pwd)\n  case Seq(ext, directory) => (ext, os.Path(directory))\n  case other => \n    println(s"Expected: `extension [directory]` but get: `${other.mkString(" ")}`")\n    sys.exit(1)\n\nval files = filesByExtension(ext, directory)\nfiles.map(_.relativeTo(directory)).foreach(println)\n')),(0,l.kt)("p",null,"As you probably noticed, we are using ",(0,l.kt)("inlineCode",{parentName:"p"},"os-lib")," in our script without any using directive, how is that possible? Actually, configuration provided by using directives are global and applies to all files. Since ",(0,l.kt)("inlineCode",{parentName:"p"},"files.scala")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"countByExtension.sc")," are compiled together. Defining a library dependency in more then one file is an anti-pattern. "),(0,l.kt)("p",null,"Let's try it:"),(0,l.kt)(r,{mdxType:"ChainedSnippets"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli . -- scala\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"files.scala\n.scala/project_940fb43dce/src_generated/main/countByExtension.scala\nfiles.test.scala\n"))),(0,l.kt)("p",null,"Why do we have an additional ",(0,l.kt)("inlineCode",{parentName:"p"},".scala")," file inside ",(0,l.kt)("inlineCode",{parentName:"p"},".scala")," dir? Actually, under the hood, Scala CLI needs sometimes to preprocess provided source file (e.g. for scripts) and we compile such file from within ",(0,l.kt)("inlineCode",{parentName:"p"},".scala")," directory. "),(0,l.kt)("h2",{id:"packaging"},"Packaging"),(0,l.kt)("p",null,"We could stop here and call scala-cli on set of sources every time. Scala CLI uses caches aggressively so rollup runs are reasonable fast (less around 1500 milliseconds on my machine) but sometimes it is not fast enough or shipping sources and compiling them may be not convenient."),(0,l.kt)("p",null,"Scala CLI offers means to package your project. We can simply run:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"scala-cli package . -o countByExtension\n")),(0,l.kt)("p",null,"It will generate a thin, executable jar with the compiled code inside. We provided ",(0,l.kt)("inlineCode",{parentName:"p"},"-o")," flag to customize the binary name (by default application is written as ",(0,l.kt)("inlineCode",{parentName:"p"},"app"),"). Now we can run our project with:"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-bash"},"./countByExtension scala   \n")),(0,l.kt)("p",null,"This time it took 350 milliseconds so we have a big improvement. Created binary (a runnable jar) is self-contained and can be shipped to your colleagues or deployed."),(0,l.kt)("p",null,"We can reduce the start up time even further using ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/scala-native"},"Scala Native")," or package our application to other formats like ",(0,l.kt)("a",{parentName:"p",href:"/docs/commands/package#docker-container"},"Docker container"),", ",(0,l.kt)("a",{parentName:"p",href:"/docs/commands/package#assemblies"},"assembly")," or even ",(0,l.kt)("a",{parentName:"p",href:"/docs/commands/package#os-specific-packages"},"os-specific packages")," (.dep, .pgk etc.) All of this is outside of the scope of this guide."),(0,l.kt)("h2",{id:"summary"},"Summary"),(0,l.kt)("p",null,"We've only scratch the surface what Scala CLI can do with this guide. We prepare a set of ",(0,l.kt)("a",{parentName:"p",href:"/docs/cookbooks/intro"},"cookbooks")," showcasing solutions to some common problems as well as detailed set of ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/intro"},"guides")," for our ",(0,l.kt)("a",{parentName:"p",href:"/docs/commands/basics"},"commands"),". "),(0,l.kt)("p",null,"We have a dedicated ",(0,l.kt)("a",{parentName:"p",href:"https://discord.gg/KzQdYkZZza"},"room on Scala discord")," to ask for help or discuss anything that is Scala CLI related. For more in-depth discussion we are using ",(0,l.kt)("a",{parentName:"p",href:"https://github.com/VirtusLab/scala-cli/discussions"},"Github discussion in our repo")," and this is a best place to suggest a new feature or an improvements."))}g.isMDXComponent=!0}}]);